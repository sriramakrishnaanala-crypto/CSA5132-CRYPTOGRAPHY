#include <stdio.h>

#define BLOCK 8
#define BLOCKS 3

// Simple S-DES encryption placeholder
// (For exam demonstration purposes)
void SDES_encrypt(int in[8], int out[8]) {
    // Simple inversion + shift demo logic
    for(int i=0;i<8;i++)
        out[i] = in[i] ^ 1;
}

// XOR function
void xor(int a[8], int b[8], int out[8]) {
    for(int i=0;i<8;i++)
        out[i] = a[i] ^ b[i];
}

// Increment 8-bit counter
void increment(int counter[8]) {
    for(int i=7;i>=0;i--) {
        if(counter[i]==0) {
            counter[i]=1;
            break;
        } else {
            counter[i]=0;
        }
    }
}

int main() {

    int counter[8] = {0,0,0,0,0,0,0,0};

    int plaintext[BLOCKS][8] = {
        {0,0,0,0,0,0,0,1},
        {0,0,0,0,0,0,1,0},
        {0,0,0,0,0,1,0,0}
    };

    int ciphertext[BLOCKS][8];
    int decrypted[BLOCKS][8];

    int keystream[8];

    printf("Ciphertext:\n");

    for(int b=0;b<BLOCKS;b++) {

        SDES_encrypt(counter, keystream);

        xor(plaintext[b], keystream, ciphertext[b]);

        for(int i=0;i<8;i++)
            printf("%d", ciphertext[b][i]);
        printf(" ");

        increment(counter);
    }

    printf("\n\nDecryption:\n");

    // Reset counter
    int counter2[8] = {0,0,0,0,0,0,0,0};

    for(int b=0;b<BLOCKS;b++) {

        SDES_encrypt(counter2, keystream);

        xor(ciphertext[b], keystream, decrypted[b]);

        for(int i=0;i<8;i++)
            printf("%d", decrypted[b][i]);
        printf(" ");

        increment(counter2);
    }

    return 0;
}
