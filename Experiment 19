#include <stdio.h>
#include <string.h>
#include <openssl/des.h>

int main() {

    DES_cblock key1 = {1,2,3,4,5,6,7,8};
    DES_cblock key2 = {8,7,6,5,4,3,2,1};
    DES_cblock key3 = {1,3,5,7,2,4,6,8};

    DES_key_schedule ks1, ks2, ks3;

    DES_set_key_unchecked(&key1, &ks1);
    DES_set_key_unchecked(&key2, &ks2);
    DES_set_key_unchecked(&key3, &ks3);

    DES_cblock iv = {0};   // Initialization vector

    unsigned char plaintext[] = "HELLOWORLD12345";
    unsigned char ciphertext[sizeof(plaintext)];

    DES_ede3_cbc_encrypt(
        plaintext,
        ciphertext,
        sizeof(plaintext),
        &ks1, &ks2, &ks3,
        &iv,
        DES_ENCRYPT
    );

    printf("Ciphertext:\n");
    for(int i=0;i<sizeof(plaintext);i++)
        printf("%02X ", ciphertext[i]);

    return 0;
}
